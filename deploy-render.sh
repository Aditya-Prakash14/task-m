#!/bin/bash

echo "ğŸš€ Todo Calendar Backend - Render Deployment Guide"
echo "=================================================="
echo ""

echo "ğŸ“‹ Prerequisites:"
echo "  âœ“ Git repository initialized"
echo "  âœ“ GitHub account"
echo "  âœ“ Render account (sign up at https://render.com)"
echo ""

echo "ğŸ”— Step 1: Push to GitHub"
echo "----------------------------------------"
echo ""
echo "Run these commands:"
echo ""
echo "  git remote add origin https://github.com/YOUR_USERNAME/YOUR_REPO.git"
echo "  git branch -M main"
echo "  git push -u origin main"
echo ""
echo "âš ï¸  Replace YOUR_USERNAME and YOUR_REPO with your GitHub username and repository name"
echo ""

read -p "Have you pushed to GitHub? (y/n): " pushed

if [ "$pushed" != "y" ]; then
    echo ""
    echo "Please push to GitHub first, then run this script again."
    exit 1
fi

echo ""
echo "ğŸŒ Step 2: Deploy on Render"
echo "----------------------------------------"
echo ""
echo "1. Go to: https://dashboard.render.com/select-repo?type=web"
echo ""
echo "2. Connect your GitHub repository: Aditya-Prakash14/task-m"
echo ""
echo "3. Configure your service:"
echo "   - Name: todo-calendar-backend"
echo "   - Environment: Node"
echo "   - Region: Oregon (US West)"
echo "   - Branch: main"
echo "   - Build Command: npm install && npx prisma generate"
echo "   - Start Command: npx prisma migrate deploy && npm start"
echo ""
echo "4. Add Environment Variables:"
echo "   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”"
echo "   â”‚ Key             â”‚ Value                                            â”‚"
echo "   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤"
echo "   â”‚ DATABASE_URL    â”‚ mysql://YLVysNuS5CG8ors.root:KqbqoFfKqOd2Fp7z@gateway01.eu-central-1.prod.aws.tidbcloud.com:4000/test?sslaccept=strict â”‚"
echo "   â”‚ JWT_SECRET      â”‚ 3d267399ddc1df2bae5509a4470058f972a6e2b60bbfca63b424c5d58f2a893a â”‚"
echo "   â”‚ JWT_EXPIRE      â”‚ 7d                                               â”‚"
echo "   â”‚ NODE_ENV        â”‚ production                                       â”‚"
echo "   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜"
echo ""
echo "5. Click 'Create Web Service'"
echo ""
echo "6. Wait for deployment to complete (3-5 minutes)"
echo ""
echo ""
echo "âœ… After Deployment"
echo "----------------------------------------"
echo ""
echo "Your API will be available at: https://todo-calendar-backend.onrender.com/api"
echo ""
echo "Test your deployment:"
echo '  curl https://todo-calendar-backend.onrender.com/api/auth/register \\'
echo '    -H "Content-Type: application/json" \\'
echo '    -d '"'"'{"name":"Test User","email":"test@example.com","password":"Test123456"}'"'"
echo ""
echo "Update your Electron app:"
echo "  Edit: electron-app/renderer/js/api.js"
echo "  Change: const API_BASE_URL = 'https://todo-calendar-backend.onrender.com/api';"
echo ""
echo ""
echo "ğŸ“š Useful Commands"
echo "----------------------------------------"
echo "  View logs: Check Render dashboard â†’ Logs tab"
echo "  Redeploy: Render dashboard â†’ Manual Deploy â†’ Deploy latest commit"
echo "  Environment variables: Render dashboard â†’ Environment tab"
echo ""
echo "ğŸ‰ Happy deploying!"
